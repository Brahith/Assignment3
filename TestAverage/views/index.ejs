  <%- include Partials/header.ejs %>

  <h1>Test Calculator</h1>
  <form id="testForm">
    <div>
      <label for="subject">Test Subject</label>
      <input type="text" id="subject" name="subject" required>
    </div>
    <div>
      <label for="mark">Mark (%)</label>
      <input type="number" id="mark" name="mark" required min="0" max="100">
    </div>
    <div>
      <label for="weight">Weight (%)</label>
      <input type="number" id="weight" name="weight" required min="0" max="100">
    </div>
    <div>
      <label for="date">Date of Test</label>
      <input type="date" id="date" name="date" required>
    </div>
    <button type="submit">Add Test</button>
  </form>

  <table>
    <thead>
      <tr>
        <th>Subject</th>
        <th>Mark (%)</th>
        <th>Weight (%)</th>
        <th>Date</th>
        <th>Weighted Score (%)</th>
      </tr>
    </thead>
    <tbody id="testTableBody"></tbody>
  </table>

  <script src="/script.js">

  const form = document.getElementById("testForm");
  const tableBody = document.getElementById("testTableBody");

  form.addEventListener("submit", async (event) => {
  event.preventDefault();

  // Get form data
  let subject = document.getElementById("subject").value;
  let mark = parseFloat(document.getElementById("mark").value);
  let weight = parseFloat(document.getElementById("weight").value);
  let date = document.getElementById("date").value;

  // Calculate weighted score
  const weightedScore = (mark * weight) / 100;

  // Send data to server
  const response = await fetch("/submit-test", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({subject, mark, weight, date, weightedScore}),
  });

  if (response.ok) {
    // Add a new row to the table
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${subject}</td>
      <td>${mark.toFixed(2)}</td>
      <td>${weight.toFixed(2)}</td>
      <td>${date}</td>
      <td>${weightedScore.toFixed(2)}</td>
    `;
    tableBody.appendChild(row);

    // Reset the form
    form.reset();
  } else {
    alert("Failed to submit data");
  }
});
  </script> <!-- Link to external JavaScript -->

<%- include Partials/footer.ejs %>